Тэги: #ansible #playbook #plays #task
Ссылки: 
## PLAYBOOK
- используется для выполнения нескольких действий на многочисленных хостах
- позволяет задать "логику" выполнения, когда task выполняется в зависимости от результатов другого task
- позволяет реализовать условия (условия when)
## PLAYS
в playbook заданы несколько ```plays```. Каждый ``play`` имеет свой заголовок, включающий различные свойства. В одном `PLAY` может быть несколько ```TASK```.

## TASK
В разделе `tasks` - описываются сами задания

![[Pasted image 20240209134228.png]]

## YAML
Язык на котором написан `PLAYBOOK - YAML`. Он легко дает возможность задать отношения между родительским и дочерними объектами. Ключевые моменты в `YAML`
- использование отступов, что позволяет идентифицировать родитель/подчиненный объект
- отступы - это пробелы, не табуляция.
- использование при задании `task` пары `key : value` - современная нотация. старая нотация  `key = value` 
- несколько аргументов модуля можно задать используя `-`
-
Требуется дополнительная настройка vi, в файле ~/.vimrc, задаем:
- filetype indent on - " Load an indent file for the detected file type.
- **set ai** — включим автоотступы для новых строк
- set ts=2 : ts stands for tabstop. It sets the tab width to 2 spaces
- set expandtab - Use space characters instead of tabs.

```
autocmd BufEnter *.yaml setlocal tabstop=2 sts=2 shiftwidth=2 expandtab autoindent             
```


![[Pasted image 20240209134228.png]]
- Каждый `playbook` начинается с `- name: ....`
- Каждый `playbook` содержит `hosts`
- Каждый `playbook` содержит `tasks:`
- Каждый `task` начинается с `-`
модуль `debug` - необходим для хранения какой-либо информации, включая текстовую и т.д.
А вот так выглядит запуск playbook. Фактически первым действием будет `Gathering Facts`, то есть информации о управляемых хостах. Эта информация будет храниться в кэше фактов, и их можно будте использовать позже.
![[Pasted image 20240209135834.png]]